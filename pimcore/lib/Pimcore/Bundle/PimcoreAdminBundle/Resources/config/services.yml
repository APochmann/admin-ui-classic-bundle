services:
    #
    # SESSION
    #

    pimcore_admin.session.configurator.admin_session_bags:
        class: Pimcore\Bundle\PimcoreAdminBundle\Session\AdminSessionBagConfigurator

    #
    # SECURITY
    #

    pimcore_admin.security.authentication.provider:
        class: Pimcore\Bundle\PimcoreAdminBundle\Security\Authentication\Provider\PimcoreAdminProvider

    pimcore_admin.security.firewall.listener:
        class: Pimcore\Bundle\PimcoreAdminBundle\Security\Firewall\PimcoreAdminListener
        arguments: ['@security.token_storage']

    pimcore_admin.security.form_authenticator:
        class: Pimcore\Bundle\PimcoreAdminBundle\Security\FormAuthenticator
        arguments: ['@router']

    pimcore_admin.security.user_provider:
        class: Pimcore\Bundle\PimcoreAdminBundle\Security\User\UserProvider

    # decorate the symfony encoder factory with our own
    # this allows us to use our password encoder including the user context
    # for pimcore users
    pimcore_admin.security.encoder_factory:
        class: Pimcore\Bundle\PimcoreAdminBundle\Security\Encoder\EncoderFactory
        decorates: security.encoder_factory
        arguments: ['@pimcore_admin.security.encoder_factory.inner']
        public: false

    #pimcore_admin.event_listener.authentication:
    #    class: Pimcore\Bundle\PimcoreAdminBundle\EventListener\AuthenticationListener
    #    arguments: ['@security.token_storage', '@router']
    #    tags:
    #        - { name: kernel.event_subscriber }
    #    calls:
    #        - [setLogger, ['@logger']]
    #    tags:
    #        - { name: monolog.logger, channel: security }
